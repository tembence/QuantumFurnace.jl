<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Finding a Thermal State · QuantumFurnace.jl</title><meta name="title" content="Finding a Thermal State · QuantumFurnace.jl"/><meta property="og:title" content="Finding a Thermal State · QuantumFurnace.jl"/><meta property="twitter:title" content="Finding a Thermal State · QuantumFurnace.jl"/><meta name="description" content="Documentation for QuantumFurnace.jl."/><meta property="og:description" content="Documentation for QuantumFurnace.jl."/><meta property="twitter:description" content="Documentation for QuantumFurnace.jl."/><meta property="og:url" content="https://tembence.github.io/QuantumFurnace.jl/stable/generated/tutorial_thermalize/"/><meta property="twitter:url" content="https://tembence.github.io/QuantumFurnace.jl/stable/generated/tutorial_thermalize/"/><link rel="canonical" href="https://tembence.github.io/QuantumFurnace.jl/stable/generated/tutorial_thermalize/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QuantumFurnace.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Finding a Thermal State</a><ul class="internal"><li><a class="tocitem" href="#1.-Configure-the-algorithm-parameters"><span>1. Configure the algorithm parameters</span></a></li><li><a class="tocitem" href="#2.-Define-the-system-Hamiltonian"><span>2. Define the system Hamiltonian</span></a></li><li><a class="tocitem" href="#3.-Define-the-jump-operators-for-the-evolution"><span>3. Define the jump operators for the evolution</span></a></li><li><a class="tocitem" href="#4.-Find-the-thermal-state"><span>4. Find the thermal state</span></a></li></ul></li><li><a class="tocitem" href="../tutorial_lindbladian/">Constructing the Detailed Balanced Lindbladian</a></li><li><a class="tocitem" href="../tutorial_hamiltonian/">Create a Hamiltonian</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory_oqs_dynamics/">Open Quantum System Dynamics</a></li><li><a class="tocitem" href="../theory_detailed_balance/">Detailed Balanced Lindbladian</a></li><li><a class="tocitem" href="../theory_weak_measurement/">Weak-measurement based Lindbladian Evolution</a></li><li><a class="tocitem" href="../theory_convex_combination/">Convex Combination of Lindbladians</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Finding a Thermal State</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Finding a Thermal State</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tembence/QuantumFurnace.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tembence/QuantumFurnace.jl/blob/main/docs/src/literate/tutorial_thermalize.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Finding-a-Thermal-State"><a class="docs-heading-anchor" href="#Finding-a-Thermal-State">Finding a Thermal State</a><a id="Finding-a-Thermal-State-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-a-Thermal-State" title="Permalink"></a></h1><p>In this tutorial we will give more details on one of the core functions of the software package: on how to drive a given quantum system to the thermal state via a simulated open quantum system evolution. We will see how to set up everything for the function <code>run_thermalization</code> and also what it actually does behind the curtains.</p><p>In summary, <code>run_thermalization</code> takes in a basic set of configurations (number of qubits, temperature, etc.), the Hamiltonian <span>$H$</span> that describes the system, an initial state <span>$\rho_0$</span> where the evolution starts from and the set of jumps <span>$\{A^a\}$</span> that prescribe that evolution. It will simulate the <a href="../theory_oqs_dynamics/">open quantum system evolution</a> or Lindbladian evolution with a <a href="../theory_weak_measurement/">weak-measurement based algorithm</a>. You can read more about them in the Theory section if you follow the links. Here, it is enough to just think of it as the following process:</p><ul><li>Start from an initial density matrix <span>$\rho_0$</span>.</li><li>Evolve it for a short <span>$\delta$</span> amount of time, <span>$\rho_\delta = (\mathbb{1} + \delta \mathcal{L})\rho_0 + \mathcal{O}(\delta^2) \simeq e^{\delta \mathcal{L}}(\rho_0)$</span>.</li><li>Repeat until <span>$\rho_t$</span> gets close enough to the target state <span>$\sigma_\beta = e^{-\beta H} / Z$</span>, i.e. the Gibbs state.</li></ul><p>Here the magic is still hidden in the generator <span>$\mathcal{L}$</span>, but the crucial property it has is that the dynamics it generates, given by <span>$e^{t \mathcal{L}}$</span>, has the Gibbs state as its unique fixed point. Thus if we evolve the system for a long enough time all other contribution will decay and the only state that survives is the Gibbs state.</p><p>Let us go through the main steps of the code:</p><h2 id="1.-Configure-the-algorithm-parameters"><a class="docs-heading-anchor" href="#1.-Configure-the-algorithm-parameters">1. Configure the algorithm parameters</a><a id="1.-Configure-the-algorithm-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Configure-the-algorithm-parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs">using QuantumFurnace
using LinearAlgebra

num_qubits = 3
dim = 2^num_qubits
num_energy_bits = 10
beta = 10.0
w0 = 0.05                            # Energy estimating precision
t0 = 2pi / (2^num_energy_bits * w0)  # Time estimating precision

domain = TimeDomain()

with_coherent = true                  # For exact detailed balance
with_linear_combination = false       # Gaussian transitions
a = 0.0
b = 0.0
eta = 0.0

mixing_time_bound = 10.0
delta = 0.1

config = ThermalizeConfig(
    num_qubits = num_qubits,
    with_coherent = with_coherent,
    with_linear_combination = with_linear_combination,
    domain = domain,
    beta = beta,
    a = a,
    b = b,
    num_energy_bits = num_energy_bits,
    w0 = w0,
    t0 = t0,
    mixing_time = mixing_time_bound,
    delta = delta,
);</code></pre><p><strong>Domains</strong> <span>$\quad$</span> Algorithms are translated to the quantum computer in the form of quantum circuits, a set of unitary quantum gates, that inherently work in the time domain, which is also what we mean by choosing <code>domain</code> to be <code>TimeDomain</code>. More realistically, time evolutions are decomposed into a Trotter product, which is also possible to see in our code via <code>TrotterDomain</code>. Though the original mathematical problem of finding a Lindbladian that evolves the system to the thermal state is formulated in the Bohr and Energy domains, that should pose no problem for us. We can always move from the time domain to the energy domain with the Fourier transform.</p><p><strong>Coherent term</strong> <span>$\quad$</span> It has been proven (see <a href="../theory_detailed_balance/">Theory</a>) that by adding a specific coherent term to the Lindbladian, we can have the Gibbs state as the unique fixed point of the generator. But even if we omit it by setting <code>with_coherent = false</code>, we would find an approximately good (or bad) result.</p><p><strong>Linear combinations</strong> <span>$\quad$</span> A simpler version of the theory is when we don&#39;t take a convex combination of Lindbladians. We can think of this as singling out a thin Gaussian region for which we allow transitions for certain energy differences induced by the jumps. We can also turn on the linear combination option, and thus have more borad transition while keeping the Gibbs state as the target state (see <a href="../theory_convex_combination/">Theory</a>).</p><h2 id="2.-Define-the-system-Hamiltonian"><a class="docs-heading-anchor" href="#2.-Define-the-system-Hamiltonian">2. Define the system Hamiltonian</a><a id="2.-Define-the-system-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Define-the-system-Hamiltonian" title="Permalink"></a></h2><p>Next, we will define and construct the Hamiltonian of the subsystem we want to thermalize. We will use the function called <code>create_hamham</code>. If we know how the terms in our Hamiltonian decompose into tensor products of single qubit terms, then this function will generate a Hamiltonian whose spectrum is within [0.0, 0.45] and creates a HamHam object with some other necessary fields in it like its eigenvectors, or its Gibbs state.</p><pre><code class="language-julia hljs">X::Matrix{ComplexF64} = [0 1; 1 0]
Y::Matrix{ComplexF64} = [0.0 -im; im 0.0]
Z::Matrix{ComplexF64} = [1 0; 0 -1]

hamiltonian_terms = [[X, X], [Y, Y], [Z, Z]]
hamiltonian_coeffs = fill(1.0, length(hamiltonian_terms))
disordering_term = [Z]
disordering_coeffs = rand(num_qubits);</code></pre><p>Generate a 4-qubit chain antiferromagnetic Heisenberg Hamiltonian with a disordering field</p><pre><code class="language-julia hljs">hamiltonian = create_hamham(hamiltonian_terms, hamiltonian_coeffs, disordering_term, disordering_coeffs, num_qubits)
hamiltonian.gibbs = Hermitian(gibbs_state_in_eigen(hamiltonian, beta));</code></pre><p>Note that we added here a disordering field to the Hamiltonian in order to make its spectrum unique. A priori the algorithm should also work with degenerate spectra, but a unique one definitely makes things easier to converge. Nevertheless exploring what effects a degenerate spectrum have on the algorithm would be quite interesting too.</p><h2 id="3.-Define-the-jump-operators-for-the-evolution"><a class="docs-heading-anchor" href="#3.-Define-the-jump-operators-for-the-evolution">3. Define the jump operators for the evolution</a><a id="3.-Define-the-jump-operators-for-the-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Define-the-jump-operators-for-the-evolution" title="Permalink"></a></h2><pre><code class="language-julia hljs">jump_set = [[X], [Y], [Z]];</code></pre><p>1-site Pauli jumps are generated over each system site and save their form in the eigenbasis we work in for effficiency:</p><pre><code class="language-julia hljs">jumps::Vector{JumpOp} = []
jump_normalization = sqrt(length(jump_set) * num_qubits)
for jump_a in jump_set
    for site in 1:num_qubits
        jump_op = Matrix(pad_term(jump_a, num_qubits, site)) / jump_normalization
        jump_op_in_eigenbasis = hamiltonian.eigvecs&#39; * jump_op * hamiltonian.eigvecs
        orthogonal = (jump_op == transpose(jump_op))
        jump = JumpOp(jump_op, jump_op_in_eigenbasis, orthogonal)
        push!(jumps, jump)
    end
end</code></pre><p>Even though it seems unassuming, that we use single-site Pauli jump operators, the actual jumps that are applied to the system are spread out time evolved operators of the form <span>$A(t) = f(t) e^{iHt} A e^{-iHt}$</span>, with some Gaussian filter function <span>$f(t)$</span>. Since the time evolutions can be quite large, while the simulable systems quite small, the actual jumps are effectively full system sized in most cases. The jump normalization is required for the block encoding in the algorithm, as the operators should have a norm less than or equal to 1.</p><h2 id="4.-Find-the-thermal-state"><a class="docs-heading-anchor" href="#4.-Find-the-thermal-state">4. Find the thermal state</a><a id="4.-Find-the-thermal-state-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Find-the-thermal-state" title="Permalink"></a></h2><p>Finally we can run the core function, that we will evolve the initial state by approximated Lindbladian evolution, always a <span>$\delta$</span> step at a time. The result then will be deviating by <span>$\mathcal{O}(\delta^2)$</span> errors from the target Gibbs state.</p><pre><code class="language-julia hljs">initial_dm = Matrix{ComplexF64}(I(dim) / dim);</code></pre><p>Evolve the system:</p><pre><code class="language-julia hljs">results = run_thermalization(jumps, config, initial_dm, hamiltonian)

println(&quot;\n Last distance to Gibbs: %s\n&quot;, results.distances_to_gibbs[end])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">--- The Press ---
domain: TimeDomain()
num_qubits: 3
num_energy_bits: 10
beta: 10.0
a: 0.0
b: 0.0
t0: 0.1227184630308513
w0: 0.05
with_coherent: true
with_linear_combination: false
mixing time: 10.0
delta: 0.1
unravel: false
-----------------
Thermalizing (Time)
Gaussian
Gaussian
Dist to Gibbs: 0.44552443137737324
Dist to Gibbs: 0.44017312616604987
Dist to Gibbs: 0.43488735376980725
Dist to Gibbs: 0.42966625807569286
Dist to Gibbs: 0.4245089962998209
Dist to Gibbs: 0.41941473870044205
Dist to Gibbs: 0.41438266829971593
Dist to Gibbs: 0.4094119806138493
Dist to Gibbs: 0.40450188339128923
Dist to Gibbs: 0.399651596358661
Dist to Gibbs: 0.3948603509741644
Dist to Gibbs: 0.39012739018815346
Dist to Gibbs: 0.3854519682106305
Dist to Gibbs: 0.38083335028540616
Dist to Gibbs: 0.37627081247068156
Dist to Gibbs: 0.37176364142582197
Dist to Gibbs: 0.3673111342040961
Dist to Gibbs: 0.36291259805117637
Dist to Gibbs: 0.3585673502091876
Dist to Gibbs: 0.3542747177261146
Dist to Gibbs: 0.3500340372703787
Dist to Gibbs: 0.3458446549504038
Dist to Gibbs: 0.34170592613899864
Dist to Gibbs: 0.3376172153023915
Dist to Gibbs: 0.33357789583375397
Dist to Gibbs: 0.3295873498910663
Dist to Gibbs: 0.32564496823917155
Dist to Gibbs: 0.32175015009588254
Dist to Gibbs: 0.31790230298200073
Dist to Gibbs: 0.31410084257512066
Dist to Gibbs: 0.3103451925670924
Dist to Gibbs: 0.3066347845250209
Dist to Gibbs: 0.3029690577556855
Dist to Gibbs: 0.29934745917327277
Dist to Gibbs: 0.2957694431703058
Dist to Gibbs: 0.2922344714916765
Dist to Gibbs: 0.28874201311167325
Dist to Gibbs: 0.2852915441139137
Dist to Gibbs: 0.2818825475740868
Dist to Gibbs: 0.27851451344541533
Dist to Gibbs: 0.27518693844675624
Dist to Gibbs: 0.27189932595325317
Dist to Gibbs: 0.2686511858894626
Dist to Gibbs: 0.26544203462487853
Dist to Gibbs: 0.26227139487177836
Dist to Gibbs: 0.2591387955853248
Dist to Gibbs: 0.2560437718658482
Dist to Gibbs: 0.25298586486324925
Dist to Gibbs: 0.24996462168345573
Dist to Gibbs: 0.24697959529687089
Dist to Gibbs: 0.24403034444875843
Dist to Gibbs: 0.2411164335715019
Dist to Gibbs: 0.23823743269868755
Dist to Gibbs: 0.23539291738095583
Dist to Gibbs: 0.2325824686035705
Dist to Gibbs: 0.22980567270565722
Dist to Gibbs: 0.22706212130106107
Dist to Gibbs: 0.22435141120078123
Dist to Gibbs: 0.22167314433693586
Dist to Gibbs: 0.21902692768821352
Dist to Gibbs: 0.21641237320677353
Dist to Gibbs: 0.21382909774655157
Dist to Gibbs: 0.21127672299293324
Dist to Gibbs: 0.20875487539376195
Dist to Gibbs: 0.20626318609163793
Dist to Gibbs: 0.20380129085748183
Dist to Gibbs: 0.20136883002532271
Dist to Gibbs: 0.19896544842828304
Dist to Gibbs: 0.19659079533572668
Dist to Gibbs: 0.19424452439154047
Dist to Gibbs: 0.19192629355352062
Dist to Gibbs: 0.1896357650338346
Dist to Gibbs: 0.18737260524053315
Dist to Gibbs: 0.1851364847200844
Dist to Gibbs: 0.1829270781009049
Dist to Gibbs: 0.18074406403786375
Dist to Gibbs: 0.17858712515773548
Dist to Gibbs: 0.17645594800557834
Dist to Gibbs: 0.17435022299201608
Dist to Gibbs: 0.17226964434140174
Dist to Gibbs: 0.17021391004084188
Dist to Gibbs: 0.1681827217900624
Dist to Gibbs: 0.16617578495209423
Dist to Gibbs: 0.16419280850476234
Dist to Gibbs: 0.16223350499295752
Dist to Gibbs: 0.1602975904816752
Dist to Gibbs: 0.15838478450980187
Dist to Gibbs: 0.15649481004463464
Dist to Gibbs: 0.15462739343711557
Dist to Gibbs: 0.15278226437776696
Dist to Gibbs: 0.15095915585331138
Dist to Gibbs: 0.14915780410396115
Dist to Gibbs: 0.14737794858136527
Dist to Gibbs: 0.14561933190719628
Dist to Gibbs: 0.14388169983236726
Dist to Gibbs: 0.1421648011968631
Dist to Gibbs: 0.14046838789017546
Dist to Gibbs: 0.13879221481232693
Dist to Gibbs: 0.1371360398354749
Dist to Gibbs: 0.13549962376608066

 Last distance to Gibbs: %s
0.13549962376608066</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../tutorial_lindbladian/">Constructing the Detailed Balanced Lindbladian »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 12 November 2025 15:50">Wednesday 12 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
